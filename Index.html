<!doctype html>
<html lang="pt-BR">
<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1" />
	<title>Fila - Secretaria de Indústria e Comércio</title>
	<link rel="stylesheet" href="styles.css">
</head>
<body>
	<header>
		<div class="header-left">
			<img class="logo" src="Recursos/Logo Poá.png" alt="Logo Prefeitura">
			<h1>Fila - Secretaria de Indústria e Comércio</h1>
		</div>
		<nav class="top-nav">
			<a href="#reception" id="navReception">Recepção</a>
			<a href="#public" id="navPublic">Painel Público</a>
			<a href="#departments" id="navDepartments">Painéis dos Departamentos</a>
			<a href="relatorios.html" id="navReports">Relatórios</a>
			<a href="#users" id="navUsers" class="hidden">Usuários</a>
		</nav>
		<div class="auth-actions">
			<button id="btnLogin" class="btn-primary">Entrar</button>
			<button id="btnLogout" class="btn-primary hidden">Sair</button>
		</div>
	</header>

	<main class="app">
		<!-- Tela Recepção: duas colunas -->
		<section class="screen card" id="screen-reception">
			<h2>Recepção</h2>
			<div class="screen-grid">
				<!-- Esquerda: Direcionamento e busca -->
				<div>
					<div class="reception-top">
						<div class="daily-counter">Atendimentos hoje: <span id="dailyCount">0</span></div>
					</div>
					<form id="receptionForm">
						<label>Buscar Munícipe por nome ou documento<br>
							<input type="text" id="searchMunicipe" placeholder="Digite nome ou documento">
						</label>
						<div id="searchResults" class="search-results" aria-live="polite"></div>
						<div id="selectedInfo" style="margin-top:8px;padding:10px;border-radius:8px;background:#fbfdff;border:1px solid #eef6ff">Nenhum munícipe selecionado</div>
						<label>Departamento / Sala<br>
							<select id="sala" required>
								<option value="">-- escolha --</option>
								<option value="1">Sala 1 - Junta Militar</option>
								<option value="2">Sala 2 - Procon</option>
								<option value="3">Sala 3 - Ouvidoria</option>
								<option value="4">Sala 4 - Banco do povo/PAV</option>
								<option value="5">Sala 5 - Frente de Trabalho</option>
								<option value="6">Sala 6 - PAT</option>
								<option value="60">Sala 6 - Seguro Desemprego</option>
								<option value="7">Sala 7 - Preenchimento</option>
								<option value="8">Sala 8 - SEBRAE</option>
							</select>
						</label>
						<div class="actions">
							<button type="submit">Criar atendimento</button>
						</div>
					</form>

						<!-- Inline: formulário de cadastro mostrado quando necessário -->
						<div id="inlineRegisterContainer" class="hidden" style="margin-top:12px;">
							<form id="receptionInlineRegisterForm">
								<label>Nome<br>
									<input type="text" id="inline_reg_nome" required>
								</label>
								<label>Documento<br>
									<input type="text" id="inline_reg_documento" required>
								</label>
								<label>Preferencial
									<input type="checkbox" id="inline_reg_preferencial">
								</label>
								<div class="actions">
									<button type="submit">Cadastrar Munícipe</button>
									<button type="button" id="inline_reg_cancel" class="secondary">Cancelar</button>
								</div>
							</form>
						</div>
					<div id="ticketIssued" class="ticket-issued" aria-live="polite"></div>
				</div>

				<!-- Direita: Cadastro permanente -->
				<div>
					<div class="card" style="padding:14px;">
						<h3>Cadastro</h3>
						<form id="preCadastroForm">
							<label>Nome<br>
								<input type="text" id="pre_nome" required>
							</label>
							<label>Documento<br>
								<input type="text" id="pre_documento" required>
							</label>
							<label>Endereço (Rua)<br>
								<input type="text" id="pre_rua">
							</label>
							<label>Bairro<br>
								<input type="text" id="pre_bairro">
							</label>
							<label>Cidade<br>
								<input type="text" id="pre_cidade">
							</label>
							<label>Telefone<br>
								<input type="text" id="pre_telefone">
							</label>
							<label>Preferencial
								<input type="checkbox" id="pre_preferencial">
							</label>
							<div class="actions">
								<button type="submit">Cadastrar Munícipe</button>
							</div>
						</form>
					</div>
				</div>
			</div>
		</section>

		<!-- Tela Recepção - etapa 1: cadastro do munícipe (compatibilidade) -->
		<section class="screen card hidden" id="screen-reception-register">
			<h2>Recepção — Cadastro do Munícipe</h2>
			<form id="receptionRegisterForm">
				<label>Nome<br>
					<input type="text" id="reg_nome" required>
				</label>
				<label>Documento<br>
					<input type="text" id="reg_documento" required>
				</label>
				<label>Preferencial
					<input type="checkbox" id="reg_preferencial">
				</label>
				<div class="actions">
					<button type="submit">Cadastrar Munícipe</button>
					<button type="button" id="reg_cancel" class="secondary">Cancelar</button>
				</div>
			</form>
		</section>

		<!-- Tela Painel Público -->
		<section class="screen card hidden" id="screen-public">
			<h2>Painel Público (em atendimento)</h2>
			<div id="panelGrid" class="panel-grid"></div>
		</section>

		<!-- Tela lista de departamentos -->
		<section class="screen card hidden" id="screen-departments">
			<h2>Painéis dos Departamentos</h2>
			<div class="departments-list">
				<ul>
					<li><a href="#dept-1">Sala 1 - Junta Militar</a></li>
					<li><a href="#dept-2">Sala 2 - Procon</a></li>
					<li><a href="#dept-3">Sala 3 - Ouvidoria</a></li>
					<li><a href="#dept-4">Sala 4 - Banco do povo/PAV</a></li>
					<li><a href="#dept-5">Sala 5 - Frente de Trabalho</a></li>
					<li><a href="#dept-6">Sala 6 - PAT</a></li>
					<li><a href="#dept-60">Sala 6 - Seguro Desemprego</a></li>
					<li><a href="#dept-7">Sala 7 - Preenchimento</a></li>
					<li><a href="#dept-8">Sala 8 - SEBRAE</a></li>
				</ul>
			</div>
		</section>

		<!-- Tela específica do departamento (dinâmica) -->
		<section class="screen card hidden" id="screen-department">
			<a href="#departments" class="back-link">← Voltar</a>
			<h2 id="deptTitle">Sala</h2>
			<div class="dept-controls">
				<button id="deptCallNext">Chamar próximo</button>
				<button id="deptRecall">Re-lembrar último chamado</button>
			</div>
			<div id="deptQueueList" class="queue-list"></div>
		</section>

		<!-- Tela de Login -->
		<section class="screen card hidden" id="screen-login">
			<h2>Login</h2>
			<form id="loginForm">
				<label>Email
					<input type="text" id="loginEmail" required>
				</label>
				<label>Senha
					<input type="password" id="loginPassword" required>
				</label>
				<div class="actions">
					<button type="submit">Entrar</button>
				</div>
			</form>
		</section>

		<!-- Tela Usuários (cadastro) -->
		<section class="screen card hidden" id="screen-users">
			<h2>Cadastro de Usuários</h2>
			<p>Apenas administradores podem cadastrar usuários.</p>
			<div class="users-blocks">
				<!-- Bloco de cadastro -->
				<div class="user-card">
					<h3>Cadastro / Edição</h3>
					<form id="userForm">
				<label>Email
					<input type="email" id="userEmail" required>
				</label>
				<label>Senha
					<input type="password" id="userPassword" required>
				</label>
				<label>Confirmar senha
					<input type="password" id="userPasswordConfirm" required>
				</label>
				<label>Departamento
					<select id="userDept">
							<option value="adm">Administrador (acesso total)</option>
							<option value="recepcao">Recepção (acesso apenas para registrar)</option>
							<option value="1">Junta Militar</option>
							<option value="2">Procon</option>
							<option value="3">Ouvidoria</option>
							<option value="4">Banco do povo/PAV</option>
							<option value="5">Frente de Trabalho</option>
							<option value="6">PAT</option>
							<option value="60">Seguro Desemprego</option>
							<option value="7">Preenchimento</option>
							<option value="8">SEBRAE</option>
						</select>
				</label>
				<div class="actions">
					<button type="submit">Salvar usuário</button>
					<button type="button" id="cancelUser" class="secondary">Cancelar</button>
				</div>
				</form>
				</div>

				<!-- Bloco de pesquisa / usuários cadastrados -->
				<div class="user-list-card">
					<h3>Pesquisar / Usuários cadastrados</h3>
					<div class="users-filter-bar" style="margin:10px 0;display:flex;gap:8px;align-items:center;flex-wrap:nowrap;justify-content:space-between">
						<input type="search" id="userSearch" placeholder="Pesquisar email ou nome..." style="flex:2;min-width:260px;max-width:600px;padding:8px;border-radius:6px;border:1px solid #ddd">
						<select id="userFilterDept" class="medium-select">
							<option value="">Todos os departamentos</option>
							<option value="adm">Administrador</option>
							<option value="recepcao">Recepção</option>
							<option value="1">Junta Militar</option>
							<option value="2">Procon</option>
							<option value="3">Ouvidoria</option>
							<option value="4">Banco do povo/PAV</option>
							<option value="5">Frente de Trabalho</option>
							<option value="6">PAT</option>
							<option value="60">Seguro Desemprego</option>
							<option value="7">Preenchimento</option>
							<option value="8">SEBRAE</option>
						</select>
						<select id="userSort" class="small-select">
							<option value="asc">A → Z</option>
							<option value="desc">Z → A</option>
						</select>
					</div>
					<div id="usersCount" style="margin-top:6px;font-size:0.95rem;color:#555;white-space:nowrap"></div>
					<div id="usersList" class="queue-list"></div>
				</div>
			</div>
		</section>

	</main>

	<footer>
		<!-- footer intentionally left blank for prototype presentation -->
	</footer>

<!-- Modal para escolher o que editar no usuário -->
<div id="editUserModal" class="modal hidden" role="dialog" aria-modal="true" aria-hidden="true">
	<div class="modal-content">
		<h4>O que deseja alterar?</h4>
		<div class="modal-options">
			<label><input type="radio" name="editChoice" value="email" /> Email</label>
			<label><input type="radio" name="editChoice" value="password" /> Senha</label>
			<label><input type="radio" name="editChoice" value="department" /> Departamento</label>
		</div>
		<div class="modal-actions">
			<button id="editChoiceCancel" class="secondary">Cancelar</button>
			<button id="editChoiceConfirm">Continuar</button>
		</div>
	</div>
</div>

	<!-- Supabase (opcional) -->
	<script src="supabase-config.js"></script>
	<script src="supabaseClient.js"></script>

	<script src="script.js"></script>
</body>
</html>
